http:
  routers:
    service:
      entryPoints:
        - websecure
      rule: Host(`service.local.example.com`) || Host(`service`)
      middlewares:
        - unqualified-redirect
        - authentik@docker
      service: service
    adguard-auth:
      entryPoints:
        - websecure
      rule: HostRegexp(`service.local.rushil.uk`) && PathPrefix(`/outpost.goauthentik.io/`)
      service: authentik@docker

  services:
    service:
      loadBalancer:
        servers:
          - url: https://X.X.X.X:YYYY
        passHostHeader: true

  middlewares:
    unqualified-redirect:
      redirectRegex:
        regex: ^https://([^/.]+)/(.*)
        replacement: https://${1}.local.example.com/${2}
        permanent: true
